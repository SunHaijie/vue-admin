{"remainingRequest":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Jeff/Documents/workspace-vs/vue-admin/src/views/Info/index.vue?vue&type=style&index=0&id=a7ed6d2a&lang=scss&scoped=true&","dependencies":[{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/src/views/Info/index.vue","mtime":1614523784585},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/css-loader/dist/cjs.js","mtime":1613959812332},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1613959818681},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/postcss-loader/src/index.js","mtime":1613959815802},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/sass-loader/dist/cjs.js","mtime":1613959817599},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1613959811244},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/vue-loader/lib/index.js","mtime":1613959818680}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgIi4uLy4uL3N0eWxlcy9jb25maWcuc2NzcyI7Ci5sYWJlbC13cmFwIHsKICAgICYuY2F0ZWdvcnkgeyBAaW5jbHVkZSBsYWJlbERvbShsZWZ0LCA2MCwgNDApOyB9CiAgICAmLmRhdGUgeyBAaW5jbHVkZSBsYWJlbERvbShyaWdodCwgOTMsIDQwKTsgfQogICAgJi5rZXktd29yayB7IEBpbmNsdWRlIGxhYmVsRG9tKHJpZ2h0LCA5OSwgNDApOyB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+TA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Info","sourcesContent":["<template>\n    <div>\n        <el-row :gutter=\"14\">\n            <el-col :span=\"4\">\n                <div class=\"label-wrap category\">\n                    <label for=\"\">分类：</label>\n                    <div class=\"warp-content\">\n                        <el-select v-model=\"category_value\" placeholder=\"请选择\" style=\"width: 100%;\">\n                            <el-option\n                                v-for=\"item in options.category\"\n                                :key=\"item.id\"\n                                :label=\"item.category_name\"\n                                :value=\"item.id\">\n                            </el-option>\n                        </el-select>\n                    </div>\n                </div>\n            </el-col>\n            <el-col :span=\"7\">\n                <div class=\"label-wrap date\">\n                    <label for=\"\">日期：&nbsp;&nbsp;</label>\n                    <div class=\"warp-content\">\n                        <el-date-picker\n                            style=\"width: 100%;\"\n                            v-model=\"date_value\"\n                            type=\"datetimerange\"\n                            format=\"yyyy 年 MM 月 dd 日\"\n                            value-format=\"yyyy-MM-dd HH:mm:ss\"\n                            align=\"right\"\n                            start-placeholder=\"开始日期\"\n                            end-placeholder=\"结束日期\"\n                            :default-time=\"['12:00:00', '08:00:00']\">\n                        </el-date-picker>\n                    </div>\n                </div>\n            </el-col>\n            <el-col :span=\"3\">\n                <div class=\"label-wrap key-work\">\n                    <label for=\"\">关键字：&nbsp;&nbsp;</label>\n                    <div class=\"warp-content\">\n                        <SelectVue :config=\"data.configOption\"/>\n                    </div>\n                </div>\n            </el-col>\n            <el-col :span=\"3\">\n                <el-input v-model=\"search_keyWork\" placeholder=\"请输入内容\" style=\"width: 100%;\"></el-input>\n            </el-col>\n            <el-col :span=\"2\">\n                <el-button type=\"danger\" style=\"width: 100%;\" @click=\"getList\">搜索</el-button>\n            </el-col>\n            <el-col :span=\"3\">&nbsp;</el-col>\n            <el-col :span=\"2\">\n                <el-button type=\"danger\" class=\"pull-right\" style=\"width: 100%;\" @click=\"dialog_info = true\"  v-if=\"btnPerm('info:add')\">新增</el-button>\n            </el-col>\n        </el-row>\n        <!-- 表格数据 -->\n        <div class=\"black-space-30\"></div>\n        <el-table :data=\"table_data.item\" border v-loading=\"loadingData\" @selection-change=\"handleSelectionChange\" style=\"width: 100%\">\n            <el-table-column type=\"selection\" width=\"45\"></el-table-column>\n            <el-table-column prop=\"title\" label=\"标题\" width=\"750\"></el-table-column>\n            <el-table-column prop=\"categoryId\" label=\"类型\" width=\"130\" :formatter=\"toCategory\"></el-table-column>\n            <el-table-column prop=\"createDate\" label=\"日期\" width=\"237\" :formatter=\"toData\"></el-table-column>\n            <el-table-column prop=\"user\" label=\"管理员\" width=\"115\"></el-table-column>\n            <el-table-column label=\"操作\">\n                <template slot-scope=\"scope\">\n                    <el-button type=\"danger\" size=\"mini\" v-btnPerm=\"'info:del'\" class=\"hiden-button\">自定义指令测试</el-button>\n                    <el-button type=\"danger\" size=\"mini\" @click=\"deleteItem(scope.row.id)\" v-btnPerm=\"'info:del'\" class=\"hiden-button\">删除</el-button>\n                    <el-button type=\"success\" size=\"mini\" @click=\"editInfo(scope.row.id)\" v-btnPerm=\"'info:edit'\" class=\"hiden-button\">编辑</el-button>\n                    <el-button type=\"success\" size=\"mini\" @click=\"detailed(scope.row)\" v-btnPerm=\"'info:detailed'\" class=\"hiden-button\">编辑详情</el-button>\n                </template>\n            </el-table-column>\n        </el-table>\n        <div class=\"black-space-30\"></div>\n        <!--底部分页-->\n        <el-row>\n            <el-col :span=\"12\">\n                <el-button size=\"medium\" @click=\"deleteAll\">批量删除</el-button>\n            </el-col>\n            <el-col :span=\"12\">\n                <el-pagination\n                    class=\"pull-right\"\n                    background\n                    @size-change=\"handleSizeChange\"\n                    @current-change=\"handleCurrentChange\"\n                    :page-sizes=\"[10, 20, 50, 100]\"\n                    layout=\"total, sizes, prev, pager, next, jumper\"\n                    :total=\"total\"\n                >\n                </el-pagination>\n            </el-col>\n        </el-row>\n        <!--新增弹窗-->\n        <DialogInfo :flag.sync=\"dialog_info\" :category=\"options.category\" @getListEmit=\"getList\" />\n        <!--修必弹窗-->\n        <DialogEditInfo :flag.sync=\"dialog_info_edit\" :id=\"infoId\" :category=\"options.category\" @getListEmit=\"getList\" />\n    </div>\n</template>\n<script>\nimport { GetCategory, GetList, DeleteInfo } from \"@/api/news\";\nimport DialogInfo from \"./dialog/info\";\nimport DialogEditInfo from \"./dialog/edit\";\nimport { global } from \"@/utils/global_V3.0\";\nimport { reactive, ref, watch, onMounted, onActivated } from '@vue/composition-api';\nimport { timestampToTime } from \"@/utils/common\";\n// 组件\nimport SelectVue from \"@c/Select\";\nexport default {\n    name: 'infoIndex',\n    components: { DialogInfo, DialogEditInfo, SelectVue },\n    setup(props, { root }) {\n        const { str: aaa, confirm } = global();\n        /**\n         * 数据\n         */\n        const data = reactive({\n            configOption: {\n                init: [\"id\", \"title\"]\n            },\n        });\n        const dialog_info = ref(false);  // true、false\n        const dialog_info_edit = ref(false);  // true、false\n        const search_key = ref('id');\n        const category_value = ref('');\n        const date_value = ref('');\n        const search_keyWork = ref('');\n        const total = ref(0);\n        const deleteInfoId = ref('');\n        const infoId = ref(\"\");\n        // loading\n        const loadingData = ref(false);\n\n        const options = reactive({\n            category: []\n        });\n        // 搜索关键字\n        const search_option = reactive([\n            { value: \"id\", label: \"ID\"},\n            { value: \"title\", label: \"标题\"},\n        ])\n        // 页码\n        const page = reactive({\n            pageNumber: 1,\n            pageSize: 10\n        })\n        // 表格数据\n        const table_data = reactive({\n            item: []\n        })\n        /**\n         * vue2.0 methods\n         */\n        const handleSizeChange = (val) => {\n            page.pageSize = val\n        }\n        const handleCurrentChange = (val) => {\n            page.pageNumber = val\n            getList()\n        }\n        /**\n         * 搜索条件处理\n         */\n        const formatData = () => {\n            let requestData = {\n                pageNumber: page.pageNumber,\n                pageSize: page.pageSize\n            };\n            // 分类ID\n            if(category_value.value) { requestData.categoryId = category_value.value }\n            // 日期\n            if(date_value.value.length > 0) {\n                requestData.startTiem = date_value.value[0]\n                requestData.endTime = date_value.value[1]\n            }\n            // 关键字\n            if(search_keyWork.value) { requestData[search_key.value] = search_keyWork.value; }\n            return requestData;\n        }\n\n        const editInfo = (id) => {\n            infoId.value = id;\n            dialog_info_edit.value = true;\n        }\n\n        /**\n         * 详情页\n         */\n        const detailed = (data) => {\n            // 预先存值\n            // root.$store.commit(\"infoDetailed/SET_ID\", data.id);\n            // root.$store.commit(\"infoDetailed/SET_TITLE\", data.title);\n            root.$store.commit(\"infoDetailed/UPDATE_STATE_VALUE\", {\n                id: {\n                    value: data.id,\n                    sessionKey: \"infoId\",\n                    session: true\n                },\n                title: {\n                    value: data.title,\n                    sessionKey: \"infoTitle\",\n                    session: true\n                }\n            });\n            // 跳转页面\n            root.$router.push({\n                name: \"InfoDetailed\",\n                params: {\n                    id: data.id, \n                    title: data.title\n                }\n            })\n        }\n        \n        const getList = () => {\n            // 单独处理数据\n            let requestData = formatData();\n            // 加载状态\n            loadingData.value = true;\n            GetList(requestData).then(response => {\n                let data = response.data.data\n                // 更新数据\n                table_data.item = data.data\n                // 页面统计数据\n                total.value = data.total\n                // 加载状态\n                loadingData.value = false;\n            }).catch(error => {\n                loadingData.value = false;\n            })\n        }\n        /**\n         * 删除数据\n         */\n        const deleteItem = (id) => {\n            deleteInfoId.value = [id];\n            confirm({\n                content: \"确认删除当前信息，确认后将无法恢复！！\",\n                tip: \"警告\",\n                fn: confirmDelete\n            })\n        }\n        const deleteAll = () => {\n            if(!deleteInfoId.value || deleteInfoId.value.length == 0) {\n                root.$message({\n                    message: \"请选择要删除的数据！！\",\n                    type: \"error\"\n                })\n                return false;\n            }\n            confirm({\n                content: \"确认删除选择的数据，确认后将无法恢复！\",\n                tip: \"警告\",\n                fn: confirmDelete\n            })\n        }\n      \n        const confirmDelete = (value) => {\n            DeleteInfo({id: deleteInfoId.value}).then(response => {\n                deleteInfoId.value = '';\n                getList()\n            })\n        }\n\n        const getInfoCategory = () => {\n            root.$store.dispatch('common/getInfoCategory').then(response => {\n                options.category = response\n            })\n        }\n\n        const toData = (row, column, cellValue, index) => {\n            return timestampToTime(row.createDate);\n        }\n\n        const toCategory = (row) => {\n            // 调用一个函数，返回一个新的值，替换原始值\n            let categoryId = row.categoryId;\n            let categoryData = options.category.filter(item => item.id == categoryId)[0];\n            if(!categoryData) { return false; }\n            return categoryData.category_name;\n        }\n\n        const handleSelectionChange = (val) => {\n            let id = val.map(item => item.id);\n            deleteInfoId.value = id\n        }\n\n\n        /**\n         * 阻塞、BUG导致整个业务流程不能进行，这个BUG，\n         * \n         */\n\n\n        \n        /**\n         * 生命周期\n         */\n        onMounted(() => {\n            // 获取分类\n            getInfoCategory();\n            // 获取列表\n            getList();\n        })\n\n        onActivated(() => {\n\n        })\n\n        return {\n            // ref\n            date_value, search_key, search_keyWork, dialog_info, category_value, total, loadingData, dialog_info_edit, infoId,\n            // reactive\n            data, table_data, options, search_option,\n            // vue2.0 methdos\n            handleSizeChange, handleCurrentChange, deleteItem, deleteAll, toData, toCategory, handleSelectionChange, getList, editInfo, detailed\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import \"../../styles/config.scss\";\n.label-wrap {\n    &.category { @include labelDom(left, 60, 40); }\n    &.date { @include labelDom(right, 93, 40); }\n    &.key-work { @include labelDom(right, 99, 40); }\n}\n</style>\n<style>\nbutton.hiden-button { display: none; }\nbutton.show-button { display: inline-block; }\n</style>"]}]}