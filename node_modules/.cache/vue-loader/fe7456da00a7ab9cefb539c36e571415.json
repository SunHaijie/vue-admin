{"remainingRequest":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Jeff/Documents/workspace-vs/vue-admin/src/views/Info/detailed.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/src/views/Info/detailed.vue","mtime":1614759444939},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1613959811244},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/babel-loader/lib/index.js","mtime":1613959810487},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1613959811244},{"path":"/Users/Jeff/Documents/workspace-vs/vue-admin/node_modules/vue-loader/lib/index.js","mtime":1613959818680}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEdldExpc3QsIEVkaXRJbmZvIH0gZnJvbSAiQC9hcGkvbmV3cyI7CmltcG9ydCB7IHRpbWVzdGFtcFRvVGltZSB9IGZyb20gIkAvdXRpbHMvY29tbW9uIjsKaW1wb3J0IHsgcmVhY3RpdmUsIHJlZiwgd2F0Y2gsIG9uTW91bnRlZCwgb25BY3RpdmF0ZWQgfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaSc7Ci8vIOe7hOS7tgppbXBvcnQgVXBsb2FkSW1nIGZyb20gIkBjL1VwbG9hZEltZyIKLy8g5a+M5paH5pys57yW6L6R5ZmoCmltcG9ydCB7IHF1aWxsRWRpdG9yIH0gZnJvbSAidnVlLXF1aWxsLWVkaXRvciI7IAppbXBvcnQgJ3F1aWxsL2Rpc3QvcXVpbGwuY29yZS5jc3MnOwppbXBvcnQgJ3F1aWxsL2Rpc3QvcXVpbGwuc25vdy5jc3MnOwppbXBvcnQgJ3F1aWxsL2Rpc3QvcXVpbGwuYnViYmxlLmNzcyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZm9EZXRhaWxlZCIsCiAgY29tcG9uZW50czogeyBxdWlsbEVkaXRvciwgVXBsb2FkSW1nIH0sCiAgc2V0dXAocHJvcHMsIHsgcm9vdCB9KXsKICAgIC8vIOWbvueJh+S4iuS8oOmFjee9rgogICAgY29uc3QgdXBsb2FkSW1nQ29uZmlnID0gcmVhY3RpdmUoewogICAgICBhY3Rpb246ICJodHRwOi8vdXAtejIucWluaXVwLmNvbSIsCiAgICAgIGFjY2Vzc2tleTogIkF2aC1FWlpBYTRUeHFQUVpzRVc0MmZYQlViVE1GaS1SS1NaVFJLSmoiLAogICAgICBzZWNyZXRrZXk6ICJsOUFYdG5oQ1ZrWmV4WE5SY21IWHptZWNYaUNVaUx5bndHYm9NZVV3IiwKICAgICAgYnVja2V0eTogIndlYmpzaHRtbCIKICAgIH0pOwoKICAgIGNvbnN0IGRhdGEgPSByZWFjdGl2ZSh7CiAgICAgIGlkOiByb290LiRyb3V0ZS5wYXJhbXMuaWQgfHwgcm9vdC4kc3RvcmUuZ2V0dGVyc1siaW5mb0RldGFpbGVkL2luZm9JZCJdLAogICAgICBjYXRlZ29yeTogW10sCiAgICAgIGVkaXRvck9wdGlvbjoge30sCiAgICAgIHN1Ym1pdExvYWRpbmc6IGZhbHNlCiAgICB9KQoKICAgIGNvbnN0IGZvcm0gPSByZWFjdGl2ZSh7CiAgICAgIGNhdGVnb3J5SWQ6ICIiLAogICAgICB0aXRsZTogIiIsCiAgICAgIGNyZWF0ZURhdGU6ICIiLAogICAgICBjb250ZW50OiAiIiwKICAgICAgaW1nVXJsOiAiIgogICAgfSkKIAoKICAgIC8qKgogICAgICAqIOiOt+WPluS/oeaBr+WIhuexuwogICAgICAqLwogICAgY29uc3QgZ2V0SW5mb0NhdGVnb3J5ID0gKCkgPT4gewogICAgICByb290LiRzdG9yZS5kaXNwYXRjaCgnY29tbW9uL2dldEluZm9DYXRlZ29yeScpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGRhdGEuY2F0ZWdvcnkgPSByZXNwb25zZQogICAgICB9KQogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W5b2T5YmNSUTnmoTkv6Hmga8KICAgICAqLwogICAgY29uc3QgZ2V0SW5mbyA9ICgpID0+IHsKICAgICAgbGV0IHJlcXVlc3REYXRhID0gewogICAgICAgIHBhZ2VOdW1iZXI6IDEsCiAgICAgICAgcGFnZVNpemU6IDEsCiAgICAgICAgaWQ6IGRhdGEuaWQKICAgICAgfQogICAgICBHZXRMaXN0KHJlcXVlc3REYXRhKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBsZXQgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhLmRhdGFbMF0KICAgICAgICBmb3JtLmNhdGVnb3J5SWQgPSByZXNwb25zZURhdGEuY2F0ZWdvcnlJZDsKICAgICAgICBmb3JtLnRpdGxlID0gcmVzcG9uc2VEYXRhLnRpdGxlOwogICAgICAgIGZvcm0uY3JlYXRlRGF0ZSA9IHRpbWVzdGFtcFRvVGltZShyZXNwb25zZURhdGEuY3JlYXRlRGF0ZSk7CiAgICAgICAgZm9ybS5jb250ZW50ID0gcmVzcG9uc2VEYXRhLmNvbnRlbnQ7CiAgICAgICAgZm9ybS5pbWdVcmwgPSByZXNwb25zZURhdGEuaW1nVXJsOwogICAgICB9KQogICAgfQoKICAgIC8qKgogICAgICog5L+d5a2Y77yI5L+u5pS55pWw5o2u5pe277yM5b+F6aG75rOo5oSP55qE77ya5LiA5a6a6ZyA6KaB5LiA5LiqSUTvvIkKICAgICAqLwogICAgY29uc3Qgc3VibWl0ID0gKCkgPT4gewogICAgICBsZXQgcmVxdWVzdERhdGEgPSB7CiAgICAgICAgaWQ6IGRhdGEuaWQsCiAgICAgICAgY2F0ZWdvcnlJZDogZm9ybS5jYXRlZ29yeUlkLAogICAgICAgIHRpdGxlOiBmb3JtLnRpdGxlLAogICAgICAgIGNvbnRlbnQ6IGZvcm0uY29udGVudCwKICAgICAgICBpbWdVcmw6IGZvcm0uaW1nVXJsCiAgICAgIH0KICAgICAgZGF0YS5zdWJtaXRMb2FkaW5nID0gdHJ1ZQogICAgICBFZGl0SW5mbyhyZXF1ZXN0RGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9IHJlc3BvbnNlLmRhdGEKICAgICAgICByb290LiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlRGF0YS5tZXNzYWdlLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgfSkKICAgICAgICBkYXRhLnN1Ym1pdExvYWRpbmcgPSBmYWxzZQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBkYXRhLnN1Ym1pdExvYWRpbmcgPSBmYWxzZQogICAgICB9KQogICAgfQoKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIGdldEluZm9DYXRlZ29yeSgpCiAgICB9KQoKICAgIG9uQWN0aXZhdGVkKCgpID0+IHsKICAgICAgZGF0YS5pZCA9IHJvb3QuJHJvdXRlLnBhcmFtcy5pZCB8fCByb290LiRzdG9yZS5nZXR0ZXJzWyJpbmZvRGV0YWlsZWQvaW5mb0lkIl07CiAgICAgIGdldEluZm8oKQogICAgfSkKCgogICAgcmV0dXJuIHsKICAgICAgZGF0YSwgZm9ybSwgc3VibWl0LCB1cGxvYWRJbWdDb25maWcKICAgIH0KICB9Cn0K"},{"version":3,"sources":["detailed.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA","file":"detailed.vue","sourceRoot":"src/views/Info","sourcesContent":["<template>\n  <el-form ref=\"form\" :model=\"form\" label-width=\"120px\">\n\n    <el-form-item label=\"信息分类：\">\n      <el-select v-model=\"form.categoryId\">\n        <el-option v-for=\"item in data.category\" :key=\"item.id\" :value=\"item.id\" :label=\"item.category_name\"></el-option>\n      </el-select>\n    </el-form-item>\n\n    <el-form-item label=\"新闻标题：\">\n      <el-input v-model=\"form.title\"></el-input>\n    </el-form-item>\n\n    <el-form-item label=\"缩略图：\">\n      <UploadImg :imgUrl.sync=\"form.imgUrl\" :config=\"uploadImgConfig\" />\n    </el-form-item>\n\n    <el-form-item label=\"发布日期：\">\n      <el-date-picker v-model=\"form.createDate\" type=\"date\" placeholder=\"选择日期\" disabled></el-date-picker>\n    </el-form-item>\n\n    <el-form-item label=\"详细内容：\">\n      <quillEditor v-model=\"form.content\" ref=\"myQuillEditor\" :options=\"data.editorOption\"/>\n    </el-form-item>\n\n    <el-form-item>\n      <el-button type=\"primary\" @click=\"submit\" :loading=\"data.submitLoading\">保存</el-button>\n    </el-form-item>\n  </el-form>\n</template>\n<script>\nimport { GetList, EditInfo } from \"@/api/news\";\nimport { timestampToTime } from \"@/utils/common\";\nimport { reactive, ref, watch, onMounted, onActivated } from '@vue/composition-api';\n// 组件\nimport UploadImg from \"@c/UploadImg\"\n// 富文本编辑器\nimport { quillEditor } from \"vue-quill-editor\"; \nimport 'quill/dist/quill.core.css';\nimport 'quill/dist/quill.snow.css';\nimport 'quill/dist/quill.bubble.css';\n\nexport default {\n  name: \"infoDetailed\",\n  components: { quillEditor, UploadImg },\n  setup(props, { root }){\n    // 图片上传配置\n    const uploadImgConfig = reactive({\n      action: \"http://up-z2.qiniup.com\",\n      accesskey: \"Avh-EZZAa4TxqPQZsEW42fXBUbTMFi-RKSZTRKJj\",\n      secretkey: \"l9AXtnhCVkZexXNRcmHXzmecXiCUiLynwGboMeUw\",\n      buckety: \"webjshtml\"\n    });\n\n    const data = reactive({\n      id: root.$route.params.id || root.$store.getters[\"infoDetailed/infoId\"],\n      category: [],\n      editorOption: {},\n      submitLoading: false\n    })\n\n    const form = reactive({\n      categoryId: \"\",\n      title: \"\",\n      createDate: \"\",\n      content: \"\",\n      imgUrl: \"\"\n    })\n \n\n    /**\n      * 获取信息分类\n      */\n    const getInfoCategory = () => {\n      root.$store.dispatch('common/getInfoCategory').then(response => {\n        data.category = response\n      })\n    }\n\n    /**\n     * 获取当前ID的信息\n     */\n    const getInfo = () => {\n      let requestData = {\n        pageNumber: 1,\n        pageSize: 1,\n        id: data.id\n      }\n      GetList(requestData).then(response => {\n        let responseData = response.data.data.data[0]\n        form.categoryId = responseData.categoryId;\n        form.title = responseData.title;\n        form.createDate = timestampToTime(responseData.createDate);\n        form.content = responseData.content;\n        form.imgUrl = responseData.imgUrl;\n      })\n    }\n\n    /**\n     * 保存（修改数据时，必须注意的：一定需要一个ID）\n     */\n    const submit = () => {\n      let requestData = {\n        id: data.id,\n        categoryId: form.categoryId,\n        title: form.title,\n        content: form.content,\n        imgUrl: form.imgUrl\n      }\n      data.submitLoading = true\n      EditInfo(requestData).then(response => {\n        let responseData = response.data\n        root.$message({\n          message: responseData.message,\n          type: 'success'\n        })\n        data.submitLoading = false\n      }).catch(error => {\n          data.submitLoading = false\n      })\n    }\n\n    onMounted(() => {\n      getInfoCategory()\n    })\n\n    onActivated(() => {\n      data.id = root.$route.params.id || root.$store.getters[\"infoDetailed/infoId\"];\n      getInfo()\n    })\n\n\n    return {\n      data, form, submit, uploadImgConfig\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n</style>"]}]}